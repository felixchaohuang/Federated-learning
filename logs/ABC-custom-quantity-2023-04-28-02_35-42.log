04-28 02:35 INFO     cuda:0
04-28 02:35 INFO     args: Namespace(model='resnet18', dataset='cifar10', net_config=None, partition='custom-quantity', batch_size=64, lr=0.001, epochs=10, ft_epochs=10, n_parties=3, alg='fedavg', use_projection_head=False, out_dim=256, loss='contrastive', temperature=0.5, comm_round=50, init_seed=2, dropout_p=0.0, datadir='./data/', reg=1e-05, logdir='./logs/', modeldir='./models/', beta=0.1, device='cuda:0', log_file_name='ABC-custom-quantity-2023-04-28-02_35-42', optimizer='adam', mu=1, noise=0, noise_type='level', rho=0, sample=1, abc='ABC', C_size=10000)
04-28 02:35 INFO     ####################################################################################################
04-28 02:35 INFO     Partitioning data
04-28 02:35 INFO     Testing lr=0.001, optimizer=sgd, batch_size=64
04-28 02:35 INFO     Initializing nets
04-28 02:35 INFO     using simple net
04-28 02:35 INFO     using simple net
04-28 02:35 INFO     using simple net
04-28 02:35 INFO     using simple net
04-28 02:35 INFO     in comm round:0
04-28 02:35 INFO     Training network 0. n_training: 1000
04-28 02:35 INFO     Training network 0
04-28 02:35 INFO     >> Pre-Training Training accuracy: 0.099
04-28 02:35 INFO     >> Pre-Training Test accuracy: 0.1035
04-28 02:35 INFO     Epoch: 0 Loss: 2.271806
04-28 02:35 INFO     Epoch: 1 Loss: 1.889858
04-28 02:35 INFO     Epoch: 2 Loss: 1.751100
04-28 02:35 INFO     Epoch: 3 Loss: 1.593913
04-28 02:36 INFO     Epoch: 4 Loss: 1.557771
04-28 02:36 INFO     Epoch: 5 Loss: 1.480393
04-28 02:36 INFO     Epoch: 6 Loss: 1.383948
04-28 02:36 INFO     Epoch: 7 Loss: 1.341382
04-28 02:36 INFO     Epoch: 8 Loss: 1.292176
04-28 02:36 INFO     Epoch: 9 Loss: 1.221274
04-28 02:36 INFO     >> Training accuracy: 0.495000
04-28 02:36 INFO     >> Test accuracy: 0.412800
04-28 02:36 INFO      ** Training complete **
04-28 02:36 INFO     net 0 final test acc 0.412800
04-28 02:36 INFO     Training network 1. n_training: 3000
04-28 02:36 INFO     Training network 1
04-28 02:36 INFO     >> Pre-Training Training accuracy: 0.10566666666666667
04-28 02:36 INFO     >> Pre-Training Test accuracy: 0.1035
04-28 02:36 INFO     Epoch: 0 Loss: 1.998167
04-28 02:36 INFO     Epoch: 1 Loss: 1.690032
04-28 02:36 INFO     Epoch: 2 Loss: 1.557473
04-28 02:36 INFO     Epoch: 3 Loss: 1.454492
04-28 02:36 INFO     Epoch: 4 Loss: 1.404589
04-28 02:36 INFO     Epoch: 5 Loss: 1.344031
04-28 02:36 INFO     Epoch: 6 Loss: 1.278952
04-28 02:36 INFO     Epoch: 7 Loss: 1.187881
04-28 02:36 INFO     Epoch: 8 Loss: 1.182768
04-28 02:36 INFO     Epoch: 9 Loss: 1.108614
04-28 02:36 INFO     >> Training accuracy: 0.585667
04-28 02:36 INFO     >> Test accuracy: 0.538300
04-28 02:36 INFO      ** Training complete **
04-28 02:36 INFO     net 1 final test acc 0.538300
04-28 02:36 INFO     Training network 2. n_training: 10000
04-28 02:36 INFO     Training network 2
04-28 02:37 INFO     >> Pre-Training Training accuracy: 0.1031
04-28 02:37 INFO     >> Pre-Training Test accuracy: 0.1035
04-28 02:37 INFO     Epoch: 0 Loss: 1.761959
04-28 02:37 INFO     Epoch: 1 Loss: 1.392127
04-28 02:37 INFO     Epoch: 2 Loss: 1.229555
04-28 02:37 INFO     Epoch: 3 Loss: 1.096230
04-28 02:38 INFO     Epoch: 4 Loss: 0.987976
04-28 02:38 INFO     Epoch: 5 Loss: 0.916827
04-28 02:38 INFO     Epoch: 6 Loss: 0.848785
04-28 02:38 INFO     Epoch: 7 Loss: 0.801433
04-28 02:38 INFO     Epoch: 8 Loss: 0.741970
04-28 02:39 INFO     Epoch: 9 Loss: 0.697217
04-28 02:39 INFO     >> Training accuracy: 0.735600
04-28 02:39 INFO     >> Test accuracy: 0.712000
04-28 02:39 INFO      ** Training complete **
04-28 02:39 INFO     net 2 final test acc 0.712000
04-28 02:39 INFO     global n_training: 782
04-28 02:39 INFO     global n_test: 313
04-28 02:39 INFO     >> Global Model Train accuracy: 0.399900
04-28 02:39 INFO     >> Global Model Test accuracy: 0.426700
04-28 02:39 INFO      -- comm_round0: valid : 0.4267
04-28 02:39 INFO     best valid so far0.4267 -- comm_round0: valid : 0.4267: loss : 2564.6973684728146
04-28 02:39 INFO     in comm round:1
04-28 02:39 INFO     Training network 0. n_training: 1000
04-28 02:39 INFO     Training network 0
04-28 02:39 INFO     >> Pre-Training Training accuracy: 0.406
04-28 02:39 INFO     >> Pre-Training Test accuracy: 0.4267
04-28 02:39 INFO     Epoch: 0 Loss: 0.926621
04-28 02:39 INFO     Epoch: 1 Loss: 0.731078
04-28 02:39 INFO     Epoch: 2 Loss: 0.610716
04-28 02:39 INFO     Epoch: 3 Loss: 0.562494
04-28 02:39 INFO     Epoch: 4 Loss: 0.511237
04-28 02:39 INFO     Epoch: 5 Loss: 0.490740
04-28 02:39 INFO     Epoch: 6 Loss: 0.422302
04-28 02:40 INFO     Epoch: 7 Loss: 0.378854
04-28 02:40 INFO     Epoch: 8 Loss: 0.391443
04-28 02:40 INFO     Epoch: 9 Loss: 0.359966
04-28 02:40 INFO     >> Training accuracy: 0.876000
04-28 02:40 INFO     >> Test accuracy: 0.703900
04-28 02:40 INFO      ** Training complete **
04-28 02:40 INFO     net 0 final test acc 0.703900
04-28 02:40 INFO     Training network 1. n_training: 3000
04-28 02:40 INFO     Training network 1
04-28 02:40 INFO     >> Pre-Training Training accuracy: 0.39266666666666666
04-28 02:40 INFO     >> Pre-Training Test accuracy: 0.4267
04-28 02:40 INFO     Epoch: 0 Loss: 0.944006
04-28 02:40 INFO     Epoch: 1 Loss: 0.780769
04-28 02:40 INFO     Epoch: 2 Loss: 0.758189
04-28 02:40 INFO     Epoch: 3 Loss: 0.700244
